# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/).

## Unreleased

### Added

### Changed

- イベントの販売ステータスをChevreへ連携するように調整

### Deprecated

### Removed

### Fixed

### Security

## v6.4.5 - 2020-08-01

### Changed

- 必要な部分のみパフォーマンス検索時にcountDocumentsを指定

## v6.4.4 - 2020-07-31

### Changed

- パフォーマンス検索を最適化

## v6.4.3 - 2020-07-31

### Changed

- パフォーマンス検索を最適化

## v6.4.2 - 2020-07-28

### Changed

- update @motionpicture/ttts-api-nodejs-client

## v6.4.1 - 2020-07-27

### Changed

- 予約検索時に不要にカウントをしないように調整

## v6.4.0 - 2020-07-22

### Changed

- ログイン認証をCognito UIで対応
- update typescript
- update tslint
- @cinerino/api-nodejs-client -> @cinerino/sdk

### Removed

- 言語切替機能を削除

## v6.3.1 - 2020-07-16

### Changed

- 購入番号として注文のpaymentNoを参照するように変更

## v6.3.0 - 2020-06-09

### Changed

- 販売停止検索処理を、apiのレート制限を考慮して調整

## v6.2.2 - 2020-06-08

### Changed

- update @motionpicture/ttts-api-nodejs-client

## v6.2.1 - 2020-06-05

### Changed

- TTTS認可サーバーを変更

## v6.2.0 - 2020-06-05

### Changed

- ログインユーザープロフィールをid_tokenから取得するように調整
- 購入アカウント検索をCinerino IAMサービスで実装

## v6.1.0 - 2020-06-04

### Changed

- イベントに対する注文返品処理時の不要なパラメータ指定を削除
- メール送信タスク作成を独自APIで実行するように変更
- イベントに対する注文返品処理をAPIから移行

## v6.0.0 - 2020-04-03

### Removed

- 代理予約機能を削除

## v5.20.0 - 2020-03-15

### Changed

- 内部予約として扱うクライアントID設定を追加

## v5.19.0 - 2020-02-18

### Changed

- 車椅子レート制限をChevreへ移行

## v5.18.0 - 2020-02-14

### Changed

- 注文確定後の余分確保分予約へのextraプロパティ連携を削除
- 独自購入番号発行を削除
- 注文取引確定後のアクションカスタムを削除
- 注文識別子カスタムを削除
- 新しい予約承認取消サービスを使用するように調整

## v5.17.1 - 2020-01-22

### Changed

- 運行停止イベントの返金対象注文検索を10件ずつ取得するように調整

## v5.17.0 - 2019-12-04

### Changed

- 券種カテゴリーレート制限を実装

## v5.16.0 - 2019-12-03

### Changed

- 券種カテゴリーレート制限解除を実装

## v5.15.0 - 2019-11-29

### Changed

- 複数のフロントエンドクライアントIDに対応
- 複数のPOSクライアントIDに対応

## v5.14.0 - 2019-11-25

### Removed

- 不要な購入完了メールを削除

## v5.13.0 - 2019-11-20

### Changed

- 注文通知設定をCinerinoプロジェクト設定で移行

## v5.12.0 - 2019-11-13

### Changed

- 購入番号をフロントで発行するように調整

## v5.11.0 - 2019-11-12

### Changed

- 注文取引確定時に注文識別子を指定

## v5.10.0 - 2019-11-11

### Changed

- 予約ごとの印刷トークンをローカルで発行するように調整
- 注文取引確定前にメール送信内容を作成するように調整

## v5.9.0 - 2019-11-08

### Changed

- 注文取引確定サービスをCinerino本家へ変更

## v5.8.0 - 2019-11-07

### Changed

- 注文取引確定時の注文通知先指定をCinerino化
- 注文取引確定時の予約連携指定をCinerino化
- 注文取引確定時の印刷トークンをアプリケーション側で生成

## v5.7.0 - 2019-11-02

### Changed

- 注文返品取引から予約通知URLの指定を削除

## v5.6.0 - 2019-11-01

### Changed

- イベントに対する注文返品処理における該当取引検索を注文番号に依存させる対応

## v5.5.0 - 2019-10-31

### Changed

- @cinerino/api-nodejs-client@2.0.0-alpha.35で再構築

## v5.4.3 - 2019-10-29

### Changed

- 注文取引の購入者プロフィール指定をCinerino化

## v5.4.2 - 2019-10-29

### Changed

- 注文取引開始時の販売者をIDで指定するように調整

## v5.4.1 - 2019-10-27

### Changed

- メール送信タスクをCinerinoで作成するように変更

## v5.4.0 - 2019-10-26

### Changed

- メール送信タスクをCinerinoで作成するように変更

## v5.3.0 - 2019-10-25

### Changed

- update @motionpicture/ttts-api-nodejs-client

## v5.2.0 - 2019-10-23

### Changed

- イベントに対する全注文返品処理タスク作成にAPI認証情報を連携

## v5.1.1 - 2019-10-23

### Fixed

- 注文取引検索のAPIエンドポイントを修正

## v5.1.0 - 2019-10-18

### Added

- 注文取引開始時にcustomerGroupを明示的に指定

## v5.0.0 - 2019-10-17

### Changed

- 注文取引フローに汎用決済承認処理を追加

## v4.10.0 - 2019-10-16

### Changed

- @cinerino/api-nodejs-clientで再構築

## v4.9.2 - 2019-10-09

### Changed

- 注文返品後アクションに予約通知アクションを指定するように変更

## v4.9.1 - 2019-10-09

### Changed

- 注文返品後アクションに予約通知アクションを指定するように変更

## v4.9.0 - 2019-10-07

### Changed

- セッション中の仮予約情報を最適化
- 注文アイテムの価格情報取得方法を調整

## v4.8.0 - 2019-09-25

### Changed

- 注文のacceptedOffersに含まれる予約情報に依存しないように調整
- 販売停止時の注文返品取引に確定後アクションを指定するように調整

## v4.7.2 - 2019-07-23

### Changed

- 券種IDと券種コードの分離対応

## v4.7.1 - 2019-07-17

### Changed

- 予約番号参照を購入番号へ移行

## v4.7.0 - 2019-07-03

### Changed

- パフォーマンス検索条件のChevre化に対応

## v4.6.0 - 2019-07-02

### Removed

- 注文取引結果からeventReservationsを削除(order.acceptedOffersへ移行)
- 仮予約インターフェースからrate_limit_unit_in_secondsを削除
- パフォーマンスインターフェースから非推奨属性を削除

### Fixed

- IE11でのArray.prototype.find対応

## v4.5.0 - 2019-06-28

### Changed

- 予約の入場以外の全属性をChevre化
- 券種インターフェースをChevre化

## v4.4.6 - 2019-06-26

### Removed

- 予約インターフェースから不要な属性を削除

## v4.4.5 - 2019-06-24

### Removed

- 予約インターフェースから不要な属性を削除
- 予約検索条件インターフェースから不要な属性を削除

## v4.4.4 - 2019-06-22

### Changed

- 予約検索以外のChevreインターフェース対応
- ツアーナンバーのChevreインターフェース対応

## v4.4.3 - 2019-06-18

### Changed

- 予約検索条件を調整

## v4.4.2 - 2019-06-17

### Changed

- 予約検索条件を調整
- 新しい予約インターフェース(Chevre)で再構築

### Removed

- 一般購入向けの不要なソースを削除

## v4.4.1 - 2019-06-10

### Fixed

- パフォーマンスのオンライン販売ステータス変更時、注文取引数が0の場合に注文取引を検索しないように調整

## v4.4.0 - 2019-06-05

### Changed

- パフォーマンス検索条件から作品関係を削除
- パフォーマンスコレクションからリレーションを削除
- jsdoc削除
- 予約リポジトリのmongooseモデルをprivate化
- パフォーマンスリポジトリのmongooseモデルをprivate化
- 新しいRedis在庫リポジトリで再構築

### Removed

- 劇場、スクリーン、作品コレクションを削除(一時的に動的データ管理を不可能に変更)

## v4.3.4 - 2019-04-05

### Changed

- TTTS-494  QRをjsで生成

## v4.3.3 - 2019-03-28

### Changed

- TTTS-492 staffの内容確認画面の予約日時を日本時間に修正

## v4.3.2 - 2019-03-19

### Changed

- QRサービスの変更

## v4.3.1 - 2018-12-22

### Changed

- 社名変更に伴うロゴの修正

## v4.3.0 - 2018-09-14

### Changed

- staff中止文言メール

## v4.2.9 - 2018-09-12

### Changed

- staff予約管理一覧の詳細画面での決済方法の表示

## v4.2.8 - 2018-08-08

### Changed

- nodejsのversion固定

## v4.2.7 - 2018-08-01

### Changed

- staff予約一覧の検索条件の日付ハイフンが消えないように修正

## v4.2.6 - 2018-06-25

### Changed

- 一括キャンセル時の POPUPを新規作成（briswell）

## v4.2.5 - 2018-05-09

### Changed

- 代理予約の際、上限枚数を超える予約を確保しようとするとエラーになるが、その際予約メモが消えてしまうのを消えないように調整。
- 検索条件リセットボタン追加
- 予約一覧から電話番号を参照追加、詳細に氏名、購入日時、決済方法、入場状況を追加
- 検索カレンダーのハイフンを削除

## v4.2.4 - 2018-04-17

### Changed

- 販売停止ステータスのイベントに対する一般予約数の表示を、ステータス変更時点での数を反映するように調整。

## v4.2.3 - 2018-03-22

### Added

- 決済方法に手売りを追加。

### Fixed

- オンライン販売中止時のスタッフ向けメール内容を調整。

## v4.2.2 - 2018-03-14

### Changed

- POSの決済方法を「---」表示に変更。

### Fixed

- 予約検索で予約方法で一般を選択した際にPOSでの購入を除外する対応。

## v4.2.1 - 2018-03-05
### Added
- 販売停止一覧表示にページャーを追加。

## v4.2.0 - 2018-02-19
### Added
- 団体印刷(印字領域72mm) を追加

### Changed
- 枠の終了日時まで予約可能なように変更。

## v4.1.0 - 2018-02-14
### Changed
- 予約検索にてPOSでの注文を判別できるように対応。

### Fixed
- 予約のテキスト検索に関して、アルファベットの大文字小文字を区別しないように調整。
- staffログイン時のエラーメッセージを修正
- staff販売中止の通知の文言修正
- 販売停止一覧表示の文言修正

## v4.0.2 - 2018-02-02
### Changed
- iisのクエリ文字列の長さ制限を調整。

## v4.0.1 - 2018-01-21
### Changed
- ci設定を追加。

## v4.0.0 - 2018-01-20
### Changed
- ttts-domain@12.0.0でリリース。

## v3.0.2 - 2017-12-13
### Changed
- APIの認証情報をCognitoから取得するように変更。

## v3.0.1 - 2017-12-13
### Removed
- 不要なコードを削除。

## v3.0.0 - 2017-12-13
### Changed
- ttts-domain@12.0.0で再実装。
